@model Question
@{
    ViewData["Title"] = "Soru Detayı";
}

<div class="page-header">
    <h2 class="page-title">Soru Detayı</h2>
    <a href="@Url.Action("Index")" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left me-2"></i>Geri Dön
    </a>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="data-card mb-4">
            <div class="data-card-header">
                <h5 class="data-card-title">@Model.Title</h5>
                <div>
                    @if (Model.IsApproved)
                    {
                        <span class="badge-status badge-active">Onaylı</span>
                    }
                    else
                    {
                        <span class="badge-status badge-pending">Onay Bekliyor</span>
                    }
                </div>
            </div>
            <div class="data-card-body">
                <div class="mb-4">
                    @Html.Raw(Model.Content.Replace("\n", "<br/>"))
                </div>
                <hr />
                <div class="d-flex justify-content-between text-muted small">
                    <span><i class="fas fa-user me-1"></i>@Model.User?.FirstName @Model.User?.LastName</span>
                    <span><i class="fas fa-calendar me-1"></i>@Model.CreatedDate.ToString("dd MMMM yyyy HH:mm")</span>
                    <span><i class="fas fa-eye me-1"></i>@Model.ViewCount görüntülenme</span>
                </div>
            </div>
        </div>
        
        <!-- Cevaplar -->
        <div class="data-card">
            <div class="data-card-header">
                <h5 class="data-card-title">
                    <i class="fas fa-comments me-2"></i>Cevaplar (@(Model.Answers?.Count ?? 0))
                </h5>
            </div>
            <div class="data-card-body">
                @if (Model.Answers != null && Model.Answers.Any())
                {
                    @foreach (var answer in Model.Answers.OrderByDescending(c => c.CreatedDate))
                    {
                        <div class="border rounded p-3 mb-3 @(answer.IsCorrectAnswer ? "border-success bg-light" : "")">
                            @if (answer.IsCorrectAnswer)
                            {
                                <span class="badge bg-success mb-2">
                                    <i class="fas fa-check me-1"></i>Doğru Cevap
                                </span>
                            }
                            <p class="mb-2">@answer.Content</p>
                            <div class="d-flex justify-content-between align-items-center text-muted small">
                                <span>
                                    <i class="fas fa-user me-1"></i>@answer.User?.FirstName @answer.User?.LastName
                                    <span class="mx-2">|</span>
                                    <i class="fas fa-calendar me-1"></i>@answer.CreatedDate.ToString("dd.MM.yyyy HH:mm")
                                </span>
                                <div>
                                    @if (answer.IsApproved)
                                    {
                                        <span class="badge-status badge-active">Onaylı</span>
                                    }
                                    else
                                    {
                                        <span class="badge-status badge-pending">Bekliyor</span>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="text-center text-muted py-4">
                        <i class="fas fa-comment-slash fa-2x mb-2 d-block"></i>
                        Henüz cevap verilmemiş.
                    </div>
                }
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="data-card mb-4">
            <div class="data-card-header">
                <h5 class="data-card-title">Bilgiler</h5>
            </div>
            <div class="data-card-body">
                <ul class="list-unstyled mb-0">
                    <li class="d-flex justify-content-between py-2 border-bottom">
                        <span class="text-muted">Kategori</span>
                        <span class="badge bg-info">@Model.Category?.CategoryName</span>
                    </li>
                    <li class="d-flex justify-content-between py-2 border-bottom">
                        <span class="text-muted">Durum</span>
                        <span class="badge-status @(Model.IsActive ? "badge-active" : "badge-inactive")">
                            @(Model.IsActive ? "Aktif" : "Pasif")
                        </span>
                    </li>
                    <li class="d-flex justify-content-between py-2 border-bottom">
                        <span class="text-muted">Görüntülenme</span>
                        <strong>@Model.ViewCount</strong>
                    </li>
                    <li class="d-flex justify-content-between py-2">
                        <span class="text-muted">Cevap Sayısı</span>
                        <strong>@(Model.Answers?.Count ?? 0)</strong>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="d-grid gap-2">
            <a href="@Url.Action("Edit", new { id = Model.QuestionId })" class="btn btn-primary">
                <i class="fas fa-edit me-2"></i>Düzenle
            </a>
            <form asp-action="Delete" method="post" 
                  onsubmit="return confirm('Bu soruyu silmek istediğinize emin misiniz?');">
                <input type="hidden" name="id" value="@Model.QuestionId" />
                <button type="submit" class="btn btn-outline-danger w-100">
                    <i class="fas fa-trash me-2"></i>Sil
                </button>
            </form>
        </div>
    </div>
</div>


